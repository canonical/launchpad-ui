/* @canonical/generator-ds 0.9.1-experimental.0 */

.ds.breadcrumbs {
  --color-background-breadcrumbs-collapse-menu-default: var(
    --tmp-color-background-default
  );
  --color-background-breadcrumbs-collapse-menu-item-active: var(
    --tmp-color-background-active
  );
  --color-background-breadcrumbs-collapse-menu-item-default: var(
    --tmp-color-background-default
  );
  --color-background-breadcrumbs-collapse-menu-item-hover: var(
    --tmp-color-background-hover
  );
  --color-background-breadcrumbs-collapse-trigger-active: var(
    --tmp-color-background-active
  );
  --color-background-breadcrumbs-collapse-trigger-default: var(
    --tmp-color-background-default
  );
  --color-border-breadcrumbs-collapse-menu: var(
    --tmp-color-border-high-contrast
  );
  --color-text-breadcrumbs: var(--tmp-color-text-default);
  --color-text-link-breadcrumbs-link-default: var(
    --tmp-color-text-link-default
  );
  --color-text-link-breadcrumbs-link-visited: var(
    --tmp-color-text-link-visited
  );
  --dimension-border-width-breadcrumbs-collapse-menu: var(
    --dimension-stroke-thickness-default
  );
  --dimension-margin-inline-breadcrumbs-separator: var(
    --tmp-dimension-spacing-inline-xxs
  );
  --dimension-margin-top-breadcrumbs-collapse-menu: var(
    --tmp-dimension-spacing-block-xxs
  );
  --dimension-min-width-breadcrumbs-collapse-menu: min(17rem, 100vw);
  --dimension-padding-block-breadcrumbs-collapse-menu-item: var(
    --tmp-dimension-spacing-block-xxs
  );
  --dimension-padding-block-breadcrumbs-collapse-menu: var(
    --tmp-dimension-spacing-block-xs
  );
  --dimension-padding-block-breadcrumbs: var(--tmp-dimension-spacing-block-xs);
  --dimension-padding-inline-breadcrumbs-collapse-menu-item: var(
    --tmp-dimension-spacing-inline-m
  );
  --dimension-padding-inline-breadcrumbs-collapse-trigger: var(
    --tmp-dimension-spacing-inline-s
  );
  --dimension-padding-inline-breadcrumbs: var(--tmp-dimension-spacing-inline-l);
  --typography-font-breadcrumbs: var(--tmp-typography-paragraph-s);

  --border-breadcrumbs-collapse-menu: var(
      --dimension-border-width-breadcrumbs-collapse-menu
    )
    solid var(--color-border-breadcrumbs-collapse-menu);

  font: var(--typography-font-breadcrumbs);
  color: var(--color-text-breadcrumbs);
  padding-inline: var(--dimension-padding-inline-breadcrumbs);
  padding-block: var(--dimension-padding-block-breadcrumbs);

  ol {
    list-style: none;
  }

  a {
    text-decoration: none;
    color: var(--color-text-link-breadcrumbs-link-default);

    &:hover {
      text-decoration: underline;
    }

    &:visited {
      color: var(--color-text-link-breadcrumbs-link-visited);
    }
  }

  > ol {
    display: flex;
    align-items: start;
    justify-content: flex-start;

    > li.collapsed {
      position: relative;

      border: var(--border-breadcrumbs-collapse-menu);
      padding-inline: var(
        --dimension-padding-inline-breadcrumbs-collapse-trigger
      );
      background-color: var(
        --color-background-breadcrumbs-collapse-trigger-default
      );

      > ol {
        left: calc(
          var(--dimension-border-width-breadcrumbs-collapse-menu) * -1
        );
        display: flex;
        flex-direction: column;
        position: absolute;
        /* `visibility: hidden` hides the elements from tab navigation, which is not what we want */
        opacity: 0;
        pointer-events: none;

        padding-block: var(--dimension-padding-block-breadcrumbs-collapse-menu);
        min-width: var(--dimension-min-width-breadcrumbs-collapse-menu);
        margin-top: var(--dimension-margin-top-breadcrumbs-collapse-menu);

        > li {
          > * {
            display: block;

            padding-block: var(
              --dimension-padding-block-breadcrumbs-collapse-menu-item
            );
            padding-inline: var(
              --dimension-padding-inline-breadcrumbs-collapse-menu-item
            );
          }

          > a {
            &:hover {
              background-color: var(
                --color-background-breadcrumbs-collapse-menu-item-hover
              );
            }

            &:active {
              background-color: var(
                --color-background-breadcrumbs-collapse-menu-item-active
              );
            }
          }
        }
      }

      &:focus-within,
      &:hover,
      &.open {
        background-color: var(
          --color-background-breadcrumbs-collapse-trigger-active
        );

        &::after {
          /* This is to not to lose hover when moving the mouse overt the gap to the child <ol> */
          content: "";
          position: absolute;
          top: 100%;
          left: 0;
          width: 100%;

          height: var(--dimension-margin-top-breadcrumbs-collapse-menu);
        }

        > ol {
          opacity: 1;
          pointer-events: auto;

          border: var(--border-breadcrumbs-collapse-menu);
          background: var(--color-background-breadcrumbs-collapse-menu-default);
        }
      }

      &::before {
        content: "..." / "";
      }

      + li li::before {
        /* Show separator before all the segments if there is a collapse section */
        content: "/" / "";
        margin-inline: var(--dimension-margin-inline-breadcrumbs-separator);
      }
    }

    > li.expanded {
      flex-grow: 1;
      flex-shrink: 1;
      overflow: hidden;

      &.no-wrap {
        white-space: nowrap;
      }

      ol,
      li {
        display: inline-block;
        max-width: 100%;
      }

      li {
        white-space: nowrap;

        &:not(.hidden) {
          overflow: hidden;
          text-overflow: ellipsis;

          + li::before {
            /* Show separator before all the segments that follow a non-hidden segment. This is in practice applies only when there is no collapse section */
            content: "/" / "";
            margin-inline: var(--dimension-margin-inline-breadcrumbs-separator);
          }
        }

        &.hidden {
          visibility: hidden;
          position: absolute;
          pointer-events: none;
        }
      }
    }
  }
}
